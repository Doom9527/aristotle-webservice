"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[41],{5282:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"filtering","title":"Filtering by Properties","description":"[Aristotle] provides powerful node filtering capabilities, allowing users to query for nodes that match specific attribute criteria, resulting in more precise and efficient data retrieval.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/filtering.md","sourceDirName":".","slug":"/filtering","permalink":"/aristotle-webservice/en/docs/filtering","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/filtering.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Filtering by Properties"},"sidebar":"tutorialSidebar","previous":{"title":"Application Deployment","permalink":"/aristotle-webservice/en/docs/deployment"},"next":{"title":"Caching","permalink":"/aristotle-webservice/en/docs/caching"}}');var i=r(4848),s=r(8453);const o={sidebar_position:4,title:"Filtering by Properties"},a="Filtering by Properties",l={},d=[{value:"How It Works",id:"how-it-works",level:3},{value:"Request Body Format",id:"request-body-format",level:4},{value:"Example Request",id:"example-request",level:4},{value:"Backend Implementation Logic",id:"backend-implementation-logic",level:3},{value:"Example Response",id:"example-response",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"filtering-by-properties",children:"Filtering by Properties"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://github.com/paion-data/aristotle/",children:"Aristotle"})," provides powerful node filtering capabilities, allowing users to query for nodes that match specific attribute criteria, resulting in more precise and efficient data retrieval."]}),"\n",(0,i.jsx)(n.h3,{id:"how-it-works",children:"How It Works"}),"\n",(0,i.jsxs)(n.p,{children:["The feature is implemented by sending a ",(0,i.jsx)(n.code,{children:"POST"})," request to the ",(0,i.jsx)(n.code,{children:"/graph"})," endpoint with a ",(0,i.jsx)(n.code,{children:"FilterQueryGraphDTO"})," object in the request body."]}),"\n",(0,i.jsx)(n.h4,{id:"request-body-format",children:"Request Body Format"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"FilterQueryGraphDTO"})," has two main fields:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"uuid"})," (string, ",(0,i.jsx)(n.strong,{children:"required"}),"): The unique identifier of the graph you want to query."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"properties"})," (object, ",(0,i.jsx)(n.strong,{children:"optional"}),"): A key-value map defining the filtering conditions.","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"key"}),": The node property key."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"value"}),": The property value to match."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"example-request",children:"Example Request"}),"\n",(0,i.jsxs)(n.p,{children:["To query for nodes where the ",(0,i.jsx)(n.code,{children:"language"})," property is ",(0,i.jsx)(n.code,{children:'"En"'})," and the ",(0,i.jsx)(n.code,{children:"status"})," property is ",(0,i.jsx)(n.code,{children:'"false"'}),", the request body would be:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "uuid": "3e308cd7b15c46bea971b43e090b18d2",\n  "properties": {\n    "language": "En",\n    "status": "false"\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"backend-implementation-logic",children:"Backend Implementation Logic"}),"\n",(0,i.jsxs)(n.p,{children:["On the backend, the ",(0,i.jsx)(n.code,{children:"getRelationByGraphUuid"})," method dynamically constructs a ",(0,i.jsx)(n.a,{href:"https://neo4j.com/developer/cypher/",children:"Cypher"})," query based on the request."]}),"\n",(0,i.jsx)(n.p,{children:"Here is the core logic:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// Base query to match the graph (g1) and its related nodes (n1, n2) and relationships (r)\nfinal String cypherQuery = "MATCH (g1:Graph { uuid: $uuid }) "\n        + "OPTIONAL MATCH (g1)-[:RELATION]->(n1:GraphNode) "\n        // Append filtering conditions for node n1 if properties are provided\n        + (properties != null && !properties.isEmpty() ?\n        getFilterProperties(Constants.NODE_ALIAS_N1, properties.entrySet()) : "")\n        + " OPTIONAL MATCH (n1)-[r:RELATION]->(n2:GraphNode) "\n        // Append filtering conditions for node n2 if properties are provided\n        + (properties != null && !properties.isEmpty() ?\n        getFilterProperties(Constants.NODE_ALIAS_N2, properties.entrySet()) : "")\n        + " RETURN DISTINCT n1, r, n2";\n'})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"getFilterProperties"})," method is responsible for converting the ",(0,i.jsx)(n.code,{children:"properties"})," map into a Cypher ",(0,i.jsx)(n.code,{children:"WHERE"})," clause fragment. It iterates over the map entries and builds a string in the format ",(0,i.jsx)(n.code,{children:"{ key1: 'value1', key2: 'value2' }"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"For the example request above, the final generated Cypher query would be approximately:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cypher",children:"MATCH (g1:Graph { uuid: \"3e308cd7b15c46bea971b43e090b18d2\" })\nOPTIONAL MATCH (g1)-[:RELATION]->(n1:GraphNode { language: 'En', status: 'false' })\nOPTIONAL MATCH (n1)-[r:RELATION]->(n2:GraphNode { language: 'En', status: 'false' })\nRETURN DISTINCT n1, r, n2\n"})}),"\n",(0,i.jsxs)(n.p,{children:["If the ",(0,i.jsx)(n.code,{children:"properties"})," field is omitted or is an empty object, no filtering conditions are appended, and the query returns all nodes and relationships in the graph."]}),"\n",(0,i.jsx)(n.admonition,{title:"Supported Query Types",type:"info",children:(0,i.jsxs)(n.p,{children:["Currently, property filtering only supports ",(0,i.jsx)(n.strong,{children:"exact matches"}),". More complex queries like fuzzy matching or range searches are not yet implemented."]})}),"\n",(0,i.jsx)(n.h3,{id:"example-response",children:"Example Response"}),"\n",(0,i.jsx)(n.p,{children:"A successful request will return a subgraph containing only the nodes and relationships that match the filter criteria."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "code": 200,\n  "msg": "Successful operation",\n  "data": {\n    "uuid": "3e308cd7b15c46bea971b43e090b18d2",\n    "title": "Language Graph",\n    "description": "Language related graph",\n    "nodes": [\n      {\n        "uuid": "2ab78d7c532b41cda028084fd8a5cdd3",\n        "properties": {\n          "status": "false",\n          "language": "En",\n          "exercitatione9": "reprehenderit tempor minim ad qui"\n        },\n        "createTime": "2024-10-19 16:07:26",\n        "updateTime": "2024-10-19 16:07:26"\n      }\n      // ... other matching nodes\n    ],\n    "relations": [\n      // ... matching relations\n    ]\n  }\n}\n'})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>a});var t=r(6540);const i={},s=t.createContext(i);function o(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);