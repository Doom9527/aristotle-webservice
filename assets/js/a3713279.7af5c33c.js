"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[588],{3876:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"deployment","title":"Deployment","description":"Aristotle deployment guide","source":"@site/docs/deployment.md","sourceDirName":".","slug":"/deployment","permalink":"/docs/deployment","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/deployment.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Deployment","description":"Aristotle deployment guide"},"sidebar":"tutorialSidebar","previous":{"title":"Configuration","permalink":"/docs/configuration"},"next":{"title":"Filtering","permalink":"/docs/filtering"}}');var i=t(4848),r=t(8453);const o={sidebar_position:4,title:"Deployment",description:"Aristotle deployment guide"},s=void 0,l={},c=[{value:"Prepare for Production Development",id:"prepare-for-production-development",level:2},{value:"Installing JDK 17",id:"installing-jdk-17",level:3},{value:"Installing Maven",id:"installing-maven",level:3},{value:"Packaging Up Aristotle",id:"packaging-up-aristotle",level:2},{value:"Starting Aristotle",id:"starting-aristotle",level:2},{value:"Getting OpenAPI Documentation",id:"getting-openapi-documentation",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Starting Aristotle throws the &quot;Failed to execute CommandLineRunner&quot; Error",id:"starting-aristotle-throws-the-failed-to-execute-commandlinerunner-error",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["This section discusses deploying ",(0,i.jsx)(n.a,{href:"https://aristotle-ws.com",children:"Aristotle"})," in production."]}),"\n",(0,i.jsx)(n.h2,{id:"prepare-for-production-development",children:"Prepare for Production Development"}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"We assume an Ubuntu 22.04+ server is used for deployment."})}),"\n",(0,i.jsx)(n.h3,{id:"installing-jdk-17",children:"Installing JDK 17"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo apt update\nsudo apt install openjdk-17-jdk\n"})}),"\n",(0,i.jsx)(n.p,{children:"If we see something similar after typing the command with the version flag below we're good to go"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'$ java -version\nopenjdk version "17.0.11" 2024-04-16\nOpenJDK Runtime Environment (build 17.0.11+9-Ubuntu-120.04.2)\nOpenJDK 64-Bit Server VM (build 17.0.11+9-Ubuntu-120.04.2, mixed mode, sharing)\n'})}),"\n",(0,i.jsx)(n.h3,{id:"installing-maven",children:"Installing Maven"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo apt install maven\n"})}),"\n",(0,i.jsx)(n.p,{children:"If we see something similar after typing the command with the version flag below we're good to go"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'$ mvn -version\nApache Maven 3.6.3\nMaven home: /usr/share/maven\nJava version: 17.0.11, vendor: Ubuntu, runtime: /usr/lib/jvm/java-17-openjdk-amd64\nDefault locale: en_US, platform encoding: UTF-8\nOS name: "linux", version: "5.4.0-182-generic", arch: "amd64", family: "unix"\n'})}),"\n",(0,i.jsx)(n.p,{children:"In the example, Maven is obviously using the correct JDK, so there is no need to set the JAVA_HOME environment variable\nextra. However, if you want to explicitly set JAVA_HOME, or in some cases (for example, when there are multiple JDK\ninstallations) make sure Maven always uses a specific JDK 17, You can add the following lines to your shell\nconfiguration file (such as.bashrc,.zshrc, or.profile) :"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"export JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64\n"})}),"\n",(0,i.jsx)(n.h2,{id:"packaging-up-aristotle",children:"Packaging Up Aristotle"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/paion-data/aristotle.git\ncd aristotle\n\nexport NEO4J_URI=YOUR_NEO4J_URI\nexport NEO4J_USERNAME=YOUR_NEO4J_USERNAME\nexport NEO4J_PASSWORD=YOUR_NEO4J_PASSWORD\nexport NEO4J_DATABASE=YOUR_NEO4J_DATABASE\n\nmvn clean package -Dmaven.test.skip=true\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://aristotle-ws.com",children:"Aristotle"})," is built on ",(0,i.jsx)(n.a,{href:"https://spring.io/projects/spring-boot",children:"Springboot"})," and has a built-in web container, which we\nused maven to package into a jar file."]}),"\n",(0,i.jsx)(n.h2,{id:"starting-aristotle",children:"Starting Aristotle"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"java -jar target/Aristotle-1.0-SNAPSHOT.jar\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The web service will run on port ",(0,i.jsx)(n.strong,{children:"8080"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"getting-openapi-documentation",children:"Getting OpenAPI Documentation"}),"\n",(0,i.jsxs)(n.p,{children:["You can access the OpenAPI documentation at ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"http://localhost:8080/doc.html",children:"http://localhost:8080/doc.html"})}),". This documentation is built using\n",(0,i.jsx)(n.strong,{children:"Swagger 2"})," and enhanced with ",(0,i.jsx)(n.strong,{children:"Knife4J"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsx)(n.h3,{id:"starting-aristotle-throws-the-failed-to-execute-commandlinerunner-error",children:'Starting Aristotle throws the "Failed to execute CommandLineRunner" Error'}),"\n",(0,i.jsxs)(n.p,{children:["For Neo4J database, Aristotle automatically\n",(0,i.jsx)(n.a,{href:"https://github.com/paion-data/aristotle/blob/master/src/main/java/com/paiondata/aristotle/config/ConstraintInitializer.java",children:"creates couple of database constraints"}),"\nat its very first contact to the database. If the ",(0,i.jsx)(n.a,{href:"#starting-aristotle",children:"startup"})," results in"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"java.lang.IllegalStateException: Failed to execute CommandLineRunner\n\tat org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:774) ~[spring-boot-2.7.3.jar!/:2.7.3]\n\tat org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:755) ~[spring-boot-2.7.3.jar!/:2.7.3]\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:315) ~[spring-boot-2.7.3.jar!/:2.7.3]\n\t...\nCaused by: org.neo4j.driver.exceptions.DatabaseException: Unable to create Constraint( name='constraint_1c8dc611', type='UNIQUENESS', schema=(:User {oidcid}) ):\nBoth Node(516397) and Node(517024) have the label `User` and property `oidcid` = 'user42fd5D645'. Note that only the first found violation is shown.\n\tat org.neo4j.driver.internal.util.Futures.blockingGet(Futures.java:111) ~[neo4j-java-driver-4.4.9.jar!/:4.4.9-e855bcc800deff6ddcf064c822314bb5c8d08c53]\n\tat org.neo4j.driver.internal.InternalTransaction.run(InternalTransaction.java:58) ~[neo4j-java-driver-4.4.9.jar!/:4.4.9-e855bcc800deff6ddcf064c822314bb5c8d08c53]\n\tat org.neo4j.driver.internal.AbstractQueryRunner.run(AbstractQueryRunner.java:34) ~[neo4j-java-driver-4.4.9.jar!/:4.4.9-e855bcc800deff6ddcf064c822314bb5c8d08c53]\n\t...\n"})}),"\n",(0,i.jsx)(n.p,{children:"then it is very likely that the Neo4J database already contains some data that prevents the constraints from being\ncreated. We recommend empty the database and start Aristotle again."})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>s});var a=t(6540);const i={},r=a.createContext(i);function o(e){const n=a.useContext(r);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);